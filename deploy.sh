#!/usr/bin/env bash

# 显示当前 npm config 配置
npm config list

git pull origin master

if [ $? -eq 0 ];then
  echo "============================================="
  echo "代码同步成功!"
  echo "============================================="
else
  echo "============================================="
  echo "代码同步失败!"
  echo "============================================="
  exit 1;
fi

npm install --verbose

if [ $? -eq 0 ];then
  echo "============================================="
  echo "依赖更新成功!"
  echo "============================================="
else
  echo "============================================="
  echo "依赖更新失败!"
  echo "============================================="
  exit 1;
fi

npm run build

if [ $? -eq 0 ];then
  echo "============================================="
  echo "代码构建成功!"
  echo "============================================="
else
  echo "============================================="
  echo "代码构建失败!"
  echo "============================================="
  exit 1;
fi

pm2 restart ua.json --env product

echo "============================================="
echo "应用启动成功!"
echo "============================================="

